---
layout: default
title: 博文
script: |
  document.addEventListener('DOMContentLoaded', () => {
    const timeline = document.querySelector('.timeline');
    const items = document.querySelectorAll('.timeline-item');
    const contentArea = document.querySelector('.content-area');
    let isDragging = false, startX, scrollLeft;

    timeline.addEventListener('mousedown', (e) => {
      isDragging = true;
      startX = e.pageX - timeline.offsetLeft;
      scrollLeft = timeline.scrollLeft;
    });
    timeline.addEventListener('mouseup', () => isDragging = false);
    timeline.addEventListener('mouseleave', () => isDragging = false);
    timeline.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      e.preventDefault();
      const x = e.pageX - timeline.offsetLeft;
      const walk = (x - startX) * 2;
      timeline.scrollLeft = scrollLeft - walk;
      updateScale();
    });
    timeline.addEventListener('touchstart', (e) => {
      isDragging = true;
      startX = e.touches[0].pageX - timeline.offsetLeft;
      scrollLeft = timeline.scrollLeft;
    });
    timeline.addEventListener('touchend', () => isDragging = false);
    timeline.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      const x = e.touches[0].pageX - timeline.offsetLeft;
      const walk = (x - startX) * 2;
      timeline.scrollLeft = scrollLeft - walk;
      updateScale();
    });

    function updateScale() {
      const timelineRect = timeline.getBoundingClientRect();
      const center = timelineRect.left + timelineRect.width / 2;
      items.forEach(item => {
        const itemRect = item.getBoundingClientRect();
        const itemCenter = itemRect.left + itemRect.width / 2;
        const distance = Math.abs(center - itemCenter);
        const scale = Math.max(1, 1.5 - distance / 300);
        item.style.transform = `scale(${scale})`;
      });
    }

    items.forEach(item => {
      item.addEventListener('click', () => {
        const url = item.dataset.url;
        fetch(url)
          .then(response => response.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const content = doc.querySelector('.post-content').innerHTML;
            contentArea.innerHTML = `
              <h1>${item.querySelector('span').textContent}</h1>
              <div class="date">${item.querySelector('.date').textContent}</div>
              <div class="post-content">${content}</div>
            `;
            contentArea.scrollIntoView({ behavior: 'smooth' });
          });
      });
    });

    timeline.addEventListener('scroll', updateScale);
    updateScale();
  });
---
<div class="content-area"></div>
<div class="timeline-wrapper">
  <div class="timeline">
    {% for post in site.posts %}
      <div class="timeline-item" data-url="{{ post.url | relative_url }}">
        <div class="date">{{ post.date | date: "%Y-%m-%d" }}</div>
        <span>{{ post.title }}</span>
      </div>
    {% endfor %}
  </div>
</div>